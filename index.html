<!DOCTYPE html>
<html>
  <head>
    <title>Staff Currently Onsite</title>
    <meta http-equiv="refresh" content="30" />
    <style>
      body {
        font-family: Arial, sans-serif;
        padding: 10px;
        background-color: white;
      }
      h2 {
        margin-top: 0;
      }
      ul {
        list-style: none;
        padding: 0;
        font-size: 0.9em;
      }
      li {
        margin-bottom: 10px;
      }
    </style>
  </head>
  <body>
    <h2>Staff Currently Onsite</h2>
    <ul id="staffList"><li>Loading...</li></ul>

    <script>
      const sheetID = "1n9xCYrVlR62WsXzZUhzviosJZzjpmk1uv-dIGtWEQ6Q";
      const sheetName = "Staff Widget Feed";
      const query = encodeURIComponent("SELECT A WHERE A IS NOT NULL");
      const url = https://docs.google.com/spreadsheets/d/${sheetID}/gviz/tq?sheet=${sheetName}&tq=${query};

      fetch(url)
        .then(response => response.text())
        .then(data => {
          const json = JSON.parse(data.substr(47).slice(0, -2));
          const rows = json.table.rows;

          const staffList = rows.map(row => <li>${row.c[0].v}</li>).join("");
          document.getElementById("staffList").innerHTML = staffList || "<li>No staff currently signed in.</li>";
        })
        .catch(error => {
          console.error("Error fetching data:", error);
          document.getElementById("staffList").innerHTML = "<li>Error loading names.</li>";
        });
    </script>
  </body>
</html>
